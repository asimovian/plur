<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: whiteboard/db/sql/statement/Request.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: whiteboard/db/sql/statement/Request.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @copyright 2015 Asimovian LLC
 * @license MIT https://github.com/asimovian/plur/blob/master/LICENSE.txt
 * @requires plur/PlurObject plur/db/message/DbRequest plur/obj/ObjParser
 */
define(['plur/PlurObject', 'plur/db/message/DbRequest', 'plur/obj/Parser'], function(PlurObject, DbRequest, ObjParser) {

/**
 * Represents a DB request for querying data.
 *
 * @constructor plur/db/message/FindRequest
 * @param namepath
 * @param columnNames
 * @param orderBy
 * @param limit
 */
var Find = function(namepath, columnNames, orderBy, limit) {
    this._targetNamepath = ( typeof(namepath) === 'undefined' ? null : namepath );
    this._columnNames = ( typeof(columnNames) === 'undefined' ? null : columnNames );
    this._orderBy = ( typeof(orderBy) === 'undefined' ? null : orderBy );
    this._limit = ( typeof(limit) === 'undefined' ? null : limit );
    this._rootCondition = null;
};

Find.prototype = PlurObject.create('plur/db/message/FindRequest', Find);

Find.OR = 'OR';
Find.AND = 'AND';
Find.EQUAL = '=';
Find.NOT_EQUAL = '!=';
Find.GREATER = '>';
Find.LESS = '&lt;';

Find.parseObj = function(o) {
	var find = new Find(o.from, o.select, o.orderBy, o.limit);
	find._rootCondition = Find.Condition.parseObj(o.where);
console.log(find);
console.log(find._rootCondition._leafConditions);
	return find;
}

PlurObjParser.get().registerParser(Find.namepath, Find.parseObj);


Find.prototype.AND = Find.AND;
Find.prototype.OR = Find.OR;
Find.prototype.EQUAL = Find.EQUAL;
Find.prototype.NOT_EQUAL = Find.NOT_EQUAL;
Find.prototype.GREATER = Find.GREATER;
Find.prototype.LESS = Find.LESS;

Find.prototype.select = function(columnNames) {
    this._columnNames = columnNames;
    return this;
};

Find.prototype.getColumns = function() {
    return this._columnNames;
};

Find.prototype.from = function(namepath) {
    this._targetNamepath = namepath;
    return this;
};

Find.prototype.getTargetNamepath = function() {
    return this._targetNamepath;
};

Find.prototype.where = function(conditionOrColumn, op, value) {
    this._rootCondition = ( typeof(op) === 'undefined' ? conditionOrColumn : new Find.Condition(conditionOrColumn, op, value) );
    this._rootCondition._request = this;
    return this._rootCondition;
};

Find.prototype.getRootCondition = function() {
    return this._rootCondition;
};

Find.prototype.limit = function(num) {
    this._limit = num;
    return this;
};

Find.prototype.getLimit = function() {
    return this._limit;
};

Find.prototype.orderBy = function(orderBy) {
    this._orderBy = orderBy;
    return this;
};

Find.prototype.getOrder = function() {
	return this._orderBy;
}

Find.prototype.toObj = function() {
    var o = {
        namepath: Find.namepath,
        from: this._targetNamepath
    };

    if (this._columnNames != null) {
        o.select = this._columnNames;
    }
    if (this._rootCondition) {
        o.where = this._rootCondition.toObj();
    }
    if (this._orderBy != null) {
        o.orderBy = this._orderBy;
    }
    if (this._limit != null) {
       o.limit = this._limit;
    }

    return o;
}

Find.Condition = function(column, op, value) {
    this._column = column;
    this._op = op;
    this._value = value;
    this._leafConditions = []
    this._logicOp = null;
};

Find.Condition.parseObj = function(o) {
	var c = new Find.Condition(o.column, o.op, o.value);
	if (typeof(o.logicOp) !== 'undefined') {
		c._logicOp = o.logicOp;
	}
	
	if (typeof(o.conditions) !== 'undefined') {
		for (var i = 0; i &lt; o.conditions.length; ++i) {
			c._leafConditions.push(Find.Condition.parseObj(o.conditions[i]));
		}
	}

	return c;
};

Find.Condition.prototype = {
	getLeafConditions: function() {
		return this._leafConditions;
	},

	getLogicOperator: function() {
		return this._logicOp;
	},
	
	getColumn: function() {
		return this._column;
	},
	
	getOperator: function() {
		return this._op;
	},
	
	getValue: function() {
		return this._value;
	},	
	
	and: function(conditionOrColumn, op, value) {
        var condition = ( typeof(op) === 'undefined' ? conditionOrColumn : new Find.Condition(conditionOrColumn, op, value) );
        condition._request = this._request;
        condition._logicOp = Find.AND;
	    this._leafConditions.push(condition);	
        return this;
	},

	or: function(conditionOrColumn, op, value) {
        var condition = ( typeof(op) === 'undefined' ? conditionOrColumn : new Find.Condition(conditionOrColumn, op, value) );
        condition._request = this._request;
        condition._logicOp = Find.OR;
	    this._leafConditions.push(condition);	
        return this;
	},
    
    orderBy: function(statements) {
        return this._request.orderBy(statements);
    },

    limit: function(num) {
        return this._request.limit(num);
    },

    toObj: function() {
        var o = {
            column: this._column,
            op: this._op,
            value: this._value
        };

        if (this._logicOp !== null) {
        	o.logicOp = this._logicOp;
        }
        
        if (this._leafConditions.length > 0) {
            o.conditions = [];
            for (var i = 0; i &lt; this._leafConditions.length; ++i) {
                o.conditions.push(this._leafConditions[i].toObj());
            }
        }

        return o;
    }
};

return Find;
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-plur_crypt_ACrypt.html">plur/crypt/ACrypt</a></li><li><a href="module-plur_IPlurified.html">plur/IPlurified</a></li><li><a href="module-plur_PlurAPI.html">plur/PlurAPI</a></li><li><a href="module-plur_PlurObject.html">plur/PlurObject</a></li></ul><h3>Classes</h3><ul><li><a href="config_Runtime%250A_.html">config/Runtime
*</a></li><li><a href="module-plur_crypt_ACrypt-plur_crypt_ACrypt.html">plur/crypt/ACrypt</a></li><li><a href="module-plur_PlurAPI-PlurAPI.html">PlurAPI</a></li><li><a href="module-plur_PlurObject-PlurObject.html">PlurObject</a></li><li><a href="plur_Bootstrap%250A_.html">plur/Bootstrap
*</a></li><li><a href="plur_comm_event_Channel%250A_.html">plur/comm/event/Channel
*</a></li><li><a href="plur_comm_event_encrypted_Channel%250A_.html">plur/comm/event/encrypted/Channel
*</a></li><li><a href="plur_comm_event_encrypted_Transmission%250A_.html">plur/comm/event/encrypted/Transmission
*</a></li><li><a href="plur_comm_event_Transmission%250A_.html">plur/comm/event/Transmission
*</a></li><li><a href="plur_config_ConfigModel.html">plur/config/ConfigModel</a></li><li><a href="plur_config_Constructor%250A_.html">plur/config/Constructor
*</a></li><li><a href="plur_config_set_runtime_Singleton%250A_.html">plur/config/set/runtime/Singleton
*</a></li><li><a href="plur_crypt_Primes%250A_.html">plur/crypt/Primes
*</a></li><li><a href="plur_crypto_core_PGP%250A_.html">plur/crypto/core/PGP
*</a></li><li><a href="plur_db_message_FindRequest.html">plur/db/message/FindRequest</a></li><li><a href="plur_db_message_FindRequestQueryBuilder.html">plur/db/message/FindRequestQueryBuilder</a></li><li><a href="plur_db_msg_Request.html">plur/db/msg/Request</a></li><li><a href="global.html#plur/db/service/DbFindService">plur/db/service/DbFindService</a></li><li><a href="plur_design_APromiseMapSingleton.html">plur/design/APromiseMapSingleton</a></li><li><a href="plur_design_ASingleton.html">plur/design/ASingleton</a></li><li><a href="plur_design_Map.html">plur/design/Map</a></li><li><a href="plur_design_map_IMap%250A_.html">plur/design/map/IMap
*</a></li><li><a href="plur_design_PromiseMap.html">plur/design/PromiseMap</a></li><li><a href="plur_design_tree_MapNode.html">plur/design/tree/MapNode</a></li><li><a href="plur_directive_Directive.html">plur/directive/Directive</a></li><li><a href="plur_error_Assertion.html">plur/error/Assertion</a></li><li><a href="plur_error_Authentication.html">plur/error/Authentication</a></li><li><a href="plur_error_Banned.html">plur/error/Banned</a></li><li><a href="plur_error_Bounds.html">plur/error/Bounds</a></li><li><a href="plur_error_Command.html">plur/error/Command</a></li><li><a href="plur_error_Configuration.html">plur/error/Configuration</a></li><li><a href="plur_error_Decoding.html">plur/error/Decoding</a></li><li><a href="plur_error_Decryption.html">plur/error/Decryption</a></li><li><a href="plur_error_Denied.html">plur/error/Denied</a></li><li><a href="plur_error_Destroyed.html">plur/error/Destroyed</a></li><li><a href="plur_error_Disconnected.html">plur/error/Disconnected</a></li><li><a href="plur_error_Empty.html">plur/error/Empty</a></li><li><a href="plur_error_Encoding.html">plur/error/Encoding</a></li><li><a href="plur_error_Encryption.html">plur/error/Encryption</a></li><li><a href="plur_error_Error.html">plur/error/Error</a></li><li><a href="plur_error_Exists.html">plur/error/Exists</a></li><li><a href="plur_error_Ignored.html">plur/error/Ignored</a></li><li><a href="plur_error_Index.html">plur/error/Index</a></li><li><a href="plur_error_Input.html">plur/error/Input</a></li><li><a href="plur_error_Invalid.html">plur/error/Invalid</a></li><li><a href="plur_error_Length.html">plur/error/Length</a></li><li><a href="plur_error_Logic.html">plur/error/Logic</a></li><li><a href="plur_error_Math.html">plur/error/Math</a></li><li><a href="plur_error_NeedsCoffee.html">plur/error/NeedsCoffee</a></li><li><a href="plur_error_NotFound.html">plur/error/NotFound</a></li><li><a href="plur_error_NotRunning.html">plur/error/NotRunning</a></li><li><a href="plur_error_Null.html">plur/error/Null</a></li><li><a href="plur_error_Numberwang.html">plur/error/Numberwang</a></li><li><a href="plur_error_Offline.html">plur/error/Offline</a></li><li><a href="plur_error_Operation.html">plur/error/Operation</a></li><li><a href="plur_error_Operator.html">plur/error/Operator</a></li><li><a href="plur_error_Output.html">plur/error/Output</a></li><li><a href="plur_error_Overflow.html">plur/error/Overflow</a></li><li><a href="plur_error_Permission.html">plur/error/Permission</a></li><li><a href="plur_error_Range.html">plur/error/Range</a></li><li><a href="plur_error_Read.html">plur/error/Read</a></li><li><a href="plur_error_Request.html">plur/error/Request</a></li><li><a href="plur_error_Running.html">plur/error/Running</a></li><li><a href="plur_error_Shutdown.html">plur/error/Shutdown</a></li><li><a href="plur_error_Size.html">plur/error/Size</a></li><li><a href="plur_error_Startup.html">plur/error/Startup</a></li><li><a href="plur_error_State.html">plur/error/State</a></li><li><a href="plur_error_Syntax.html">plur/error/Syntax</a></li><li><a href="plur_error_Timeout.html">plur/error/Timeout</a></li><li><a href="plur_error_Type.html">plur/error/Type</a></li><li><a href="plur_error_Unavailable.html">plur/error/Unavailable</a></li><li><a href="plur_error_Undefined.html">plur/error/Undefined</a></li><li><a href="plur_error_Uninitialized.html">plur/error/Uninitialized</a></li><li><a href="plur_error_Unknown.html">plur/error/Unknown</a></li><li><a href="plur_error_Unsupported.html">plur/error/Unsupported</a></li><li><a href="plur_error_Untrusted.html">plur/error/Untrusted</a></li><li><a href="plur_error_Validation.html">plur/error/Validation</a></li><li><a href="plur_error_Write.html">plur/error/Write</a></li><li><a href="plur_es6_Promise%250A_.html">plur/es6/Promise
*</a></li><li><a href="plur_event_Emitter._Listener%250A_.html">plur/event/Emitter._Listener
*</a></li><li><a href="plur_event_Emitter._ListenerTreeValue%250A_.html">plur/event/Emitter._ListenerTreeValue
*</a></li><li><a href="plur_event_Emitter%250A_.html">plur/event/Emitter
*</a></li><li><a href="plur_event_Event.html">plur/event/Event</a></li><li><a href="plur_file_System.html">plur/file/System</a></li><li><a href="plur_hash_HashSingleton.html">plur/hash/HashSingleton</a></li><li><a href="global.html#plur/json/model/Transformer">plur/json/model/Transformer</a></li><li><a href="plur_log_System%250A_.html">plur/log/System
*</a></li><li><a href="plur_model_Model.html">plur/model/Model</a></li><li><a href="plur_msg_AMessageEvent%250A_.html">plur/msg/AMessageEvent
*</a></li><li><a href="plur_msg_ANotification.html">plur/msg/ANotification</a></li><li><a href="plur_msg_ARequest.html">plur/msg/ARequest</a></li><li><a href="plur_msg_AResponse.html">plur/msg/AResponse</a></li><li><a href="plur_nodejs_Bootstrap.html">plur/nodejs/Bootstrap</a></li><li><a href="plur_nodejs_file_System.html">plur/nodejs/file/System</a></li><li><a href="global.html#plur/pson/model/Transformer">plur/pson/model/Transformer</a></li><li><a href="plur_test_Test%250A_.html">plur/test/Test
*</a></li><li><a href="plur_web_Bootstrap.html">plur/web/Bootstrap</a></li></ul><h3>Interfaces</h3><ul><li><a href="-_.html">*</a></li><li><a href="module-plur_IPlurified-IPlurified.html">IPlurified</a></li><li><a href="plur_app_Application.html">plur/app/Application</a></li><li><a href="plur_app_IDaemon.html">plur/app/IDaemon</a></li><li><a href="plur_file_ISystem.html">plur/file/ISystem</a></li></ul><h3>Global</h3><ul><li><a href="global.html#plur/db/message/DbFindResponse">plur/db/message/DbFindResponse</a></li><li><a href="global.html#plur/db/message/FindQueryQueryBuilder">plur/db/message/FindQueryQueryBuilder</a></li><li><a href="global.html#plur/log/Log">plur/log/Log</a></li><li><a href="global.html#plur/model/Transformer">plur/model/Transformer</a></li><li><a href="global.html#plur/service/ServiceDirective">plur/service/ServiceDirective</a></li><li><a href="global.html#plurbootstrap">plurbootstrap</a></li><li><a href="global.html#requirejs">requirejs</a></li><li><a href="global.html#string">string</a></li><li><a href="global.html#toUrl">toUrl</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Mon Dec 05 2016 17:59:41 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
